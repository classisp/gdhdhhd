<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QR Scanner</title>
  <script src="https://unpkg.com/html5-qrcode@2.3.10/minified/html5-qrcode.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #reader { width: 300px; margin-top: 20px; }
    input, select { display: block; margin: 10px 0; padding: 8px; width: 200px; }
  </style>
</head>
<body>
  <h2>QR Scanner Autofill</h2>

  <label>Name:</label>
  <input type="text" id="name" />

  <label>Season:</label>
  <select id="season">
    <option value="">Select Season</option>
    <option value="Spring">Spring</option>
    <option value="Summer">Summer</option>
    <option value="Autumn">Autumn</option>
    <option value="Winter">Winter</option>
  </select>

  <button onclick="startScanner()">Start Scanner</button>
  <div id="reader" style="display:none;"></div>

  <script>
    const html5QrCode = new Html5Qrcode("reader");

    function startScanner() {
      document.getElementById("reader").style.display = "block";

      Html5Qrcode.getCameras().then(devices => {
        if (devices && devices.length) {
          const cameraId = devices[0].id;

          html5QrCode.start(
            cameraId,
            { fps: 10, qrbox: 250 },
            decodedText => {
              try {
                const data = JSON.parse(decodedText);
                document.getElementById("name").value = data.name || "";
                document.getElementById("season").value = data.season || "";

                html5QrCode.stop().then(() => {
                  document.getElementById("reader").style.display = "none";
                });
              } catch (err) {
                alert("QR code doesn't contain valid JSON.");
              }
            },
            errorMessage => {
              // silently ignore scan errors
            }
          );
        }
      }).catch(err => {
        alert("Camera access failed: " + err);
      });
    }
  </script>
</body>
</html>